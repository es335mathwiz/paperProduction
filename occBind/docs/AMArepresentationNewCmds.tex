%\usepackage{pseudocode}
%\usepackage{dirtree}
% \usepackage[utf8]{inputenc}
% \usepackage{listings,xcolor}

% \usepackage{soul}
% \usepackage{ulem}


\usepackage{tikz-cd}
\usepackage{amsmath}
\DeclareMathOperator*{\argmin}{arg\,min}


\usepackage{algorithm2e}
%\usepackage{algorithmicx}
\usepackage{algpseudocode}
\algrenewcommand\algorithmicwhile{\textbf{until}}
\SetKwInOut{Input}{input}
\SetKwInOut{Output}{output}



\usepackage[round,authoryear]{natbib}
%\usepackage[margin=1.0in]{geometry}
\usepackage{graphicx}
\usepackage{moreverb}
\usepackage{hyperref}
\newcommand\infNorm[1]{\left\lVert#1\right\rVert_\infty}
\newcommand\twoNorm[1]{\left\lVert#1\right\rVert_2}
\newcommand\someNorm[1]{\left\lVert#1\right\rVert}

\usepackage{mathtools}
\mathtoolsset{showonlyrefs}
\usepackage{datetime}
\usepackage{amsfonts}

\newcommand{\xgusst}[1]{x^{guess}_{#1}}
\newcommand{\xnxt}[1]{x^{next}_{#1}}
\newcommand{\znxt}[1]{z^{next}_{#1}}
\newcommand{\xlst}[1]{x^{last}_{#1}}
\newcommand{\zlst}[1]{z^{last}_{#1}}
\newcommand{\zgusst}[1]{z^{guess}_{#1}}
\newcommand{\xguss}{\xgusst{}}
\newcommand{\xtpguss}{x^{tp1guess}}


\newcommand{\iSet}{{\mathcal{I}_t}}

\newcommand{\posInt}{{\mathcal{N}^+}}
\newcommand{\Rn}[1]{{\mathcal{R}^{#1}}}
\newcommand{\numX}{{N_x}}
\newcommand{\numZ}{{N_z}}
\newcommand{\numEps}{{N_\epsilon}}
\newcommand{\numR}{{N_r}}
\newcommand{\numIters}{{K}}
\newcommand{\numTerms}{{N_{terms}}}
\newcommand{\numPts}{{N_{points}}}
\newcommand{\thePoints}{{\{(x_{t-1},\epsilon_t)^{1} \ldots (x_{t-1},\epsilon_t)^{\numPts}\}}}
\newcommand{\thePts}{{\mathcal{P}}}
\newcommand{\ADRCE}{{\bf ADRCEF}}
\newcommand{\ADR}{{\bf ADRF}}

\newcommand{\xtmEpsArg}{{x_{t-1},\epsilon_t}} 
\newcommand{\xtArg}{{x_{t} }}


\newcommand{\sumLinPart}{{
B x_{t-1}+ \phi \psi_\epsilon\epsilon + (I - F)^{-1} \phi \psi_c 
}}
\newcommand{\sumZPart}{{
 \sum_{\sForSum=0}^\infty F^s \phi z_{t+\sForSum}(x_{t-1},\epsilon) 
}}
\newcommand{\sumZPartZero}{{
 \phi z_{t}(x_{t-1},\epsilon) 
}}
\newcommand{\sumZPartPos}{{
 \sum_{\sForSum=1}^\infty F^s \phi Z_{t+\sForSum}(x_{t-1},\epsilon) 
}}

\newcommand{\EsumLinPart}{{
	 B x_{t-1}+ (I - F)^{-1} \phi \psi_c 
}}
\newcommand{\EsumZPartZero}{{
	  \sum_{\sForSum=0}^\infty F^s \phi Z^{PF}_{t+\sForSum}(x_{t-1},0) 
}}
\newcommand{\EsumZPartEpsilon}{{
	  \sum_{\sForSum=0}^\infty F^s \phi \expct{z_{t+\sForSum}(x_{t-1},\epsilon)}
}}
\newcommand{\EsumCapZPart}[1]{{
	  \sum_{\sForSum=0}^\infty F^s \phi {Z^{#1}_{t+\sForSum}(x_{t-1})}
}}
\newcommand{\uncnxpt}[2]{{\mathcal{E}\left [ \left . #1 \right | #2  \right ]}}
\newcommand{\expct}[1]{{\mathcal{E}\left [ #1 \right ]}}

\newcommand{\xzFuncGuess}{{\mathbb{g}}}
\newcommand{\xzFuncGuessIn}{{\mathbf{\mathbb{g}_{in}}}}
\newcommand{\genxzFuncGuessIn}{{\mathbf{gen\mathbb{g}_{in}}}}
\newcommand{\xzFuncGuessSig}{{(\Rn{\numX})\rightarrow
(\Rn{({\numX+\numZ})})}}


\newcommand{\xzFunc}{{{\gamma}}}
\newcommand{\xzFuncSig}{{(\Rn{\numX+\numEps})\rightarrow
(\Rn{({\numX+\numZ})})}}

\newcommand{\XZFunc}{{\mathbb{G}}}
\newcommand{\genXZFunc}{{\mathbf{gen\mathbb{G}}}}
\newcommand{\bigXFuncSig}{{(\Rn{\numX})\rightarrow
(\Rn{({\numX+\numZ})})}}


\newcommand{\genXGFP}{{\mathcal{U}}}
\newcommand{\xgFP}{{\mathcal{V}}}

\newcommand{\genFpf}{{\mathbf{gen}_\fpf}}
\newcommand{\fpf}{{\mathcal{T}}}
\newcommand{\fpfIn}{{\mathbf{t}_{in}}}
\newcommand{\fpfOut}{{\mathbf{t}_{out}}}
\newcommand{\genFpfIn}{{\mathbf{gen\fpf}_{in}}}
\newcommand{\genFpfOut}{{\mathbf{gen\fpf}_{out}}}

\newcommand{\genSlvr}{{\mathbf{gen}_{\slvr}}}
\newcommand{\slvr}{{\mathcal{S}}}
\newcommand{\slvrIn}{{\mathbf{s}_{in}}}
\newcommand{\slvrOut}{{\mathbf{s}_{out}}}
\newcommand{\genSlvrIn}{{\mathbf{gen\slvr}_{in}}}
\newcommand{\genSlvrOut}{{\mathbf{gen\slvr}_{out}}}
\newcommand{\solverSig}{{
\frfpnsRegimeFuncHelp
}}
\newcommand{\proj}[1]{{\pi_{#1}}}
\newcommand{\eqnArg}{\mathbf{m}_{in}}
\newcommand{\eqnOut}{\mathbf{m}_{err}}
\newcommand{\eqnFunc}{\mathbb{M}}
\newcommand{\eqnErrs}{{{m}_e}}
\newcommand{\eqnFuncSig}{{\Rn{3\numX+\numEps+\numZ}\rightarrow\Rn{\numX}}}


\newcommand{\lilXFuncSig}{{fix lilXFuncSig}}



\newcommand{\frfpnsFuncSig}{{\Rn{\numX+\numEps}\rightarrow\Rn{\numX+\numZ}}}

\newcommand{\bigXRegimeFuncSig}{{(\Rn{\numX+1})\rightarrow
(\Rn{({\numX+\numZ})})}}
\newcommand{\lilXRegimeFuncSig}{{(\Rn{\numX+1+\numEps+\numZ})\rightarrow
(\Rn{({3(\numX+1)+\numEps+\numZ})})}}
\newcommand{\eqnRegimeFuncSig}{{
\{\Rn{3(\numX+1)+\numEps+\numZ}\rightarrow\Rn{\numX},
\ldots,
\Rn{3(\numX+1)+\numEps+\numZ}\rightarrow\Rn{\numX}\}
}}
\newcommand{\frfpnsRegimeFuncHelp}{{\Rn{\numX+\numEps}\rightarrow\Rn{\numX+\numZ}}}

\newcommand{\frfpnsRegimeFuncSig}{{
\{ (\frfpnsRegimeFuncHelp{1}), \ldots ,  (\frfpnsRegimeFuncHelp{\numR})\}
}}

\newcommand{\dstSpec}{{\mathbf{distSpec}}}
\newcommand{\expctSpec}{{\mathbf{expctSpec}}}
\newcommand{\grdSpec}{{\mathbf{grdSpec}}}


\newcommand{\linMod}{{\mathcal{L}}}
\newcommand{\linModMats}{{\{H,\psi_\epsilon,\psi_c;B,\phi,F\}}}
\newcommand{\sForSum}{{\nu}}

\newcommand{\xWarg}{   \mathcal{X}_{t}(x_{-1},\epsilon)}
\newcommand{\xWargK}{   \hat{\mathcal{X}}_{t}(x_{-1},\epsilon,k)}


\newcommand{\xIter}[2]{\mathcal{X}^{#1}(#2)}
\newcommand{\xNow}[1]{x^{#1}_t(x_{t-1},\epsilon_t)}
\newcommand{\zNow}[1]{z^{#1}(x_{t-1},\epsilon_t)}
\newcommand{\xNowtp}[1]{x^{#1}_{t+1}(x_{t-1},\epsilon_t)}
\newcommand{\XNow}[3]{\mathcal{X}^{#1}_{#2}(x_{#3})}
\newcommand{\ZNow}[3]{\mathcal{Z}^{#1}(x_{#3})}


\newcommand{\rcpC}{{\mathbf{N}}}


\newcommand{\gssaKtp}{{\left \{  
\beta \frac{u^\prime(c_{\tau+1})}{u^\prime(c_{\tau})} 
[1- \delta + a_{t+1}f^\prime(k_{\tau+1})]
\right \} -1}}


\newenvironment{proof}[1][Proof]{\begin{trivlist}
  \item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{definition}[1][Definition]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{example}[1][Example]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}
\newenvironment{remark}[1][Remark]{\begin{trivlist}
\item[\hskip \labelsep {\bfseries #1}]}{\end{trivlist}}

\newcommand{\qed}{\nobreak \ifvmode \relax \else
      \ifdim\lastskip<1.5em \hskip-\lastskip
      \hskip1.5em plus0em minus0.5em \fi \nobreak
      \vrule height0.75em width0.5em depth0.25em\fi}

\newcommand{\xtFuncTI}{\mathcal{X}(x,\epsilon)}
\newcommand{\XtFuncTI}{\mathbf{X}(x)}
\newcommand{\expctEps}[1]{\mathcal{E}_{\epsilon} \left [#1 \right ]}
\newcommand{\xsubtFunc}[2]{\mathcal{X}_{#1}{#2}}
\newcommand{\xtFunc}[1]{\mathcal{X}{#1}}
\newcommand{\XtFunc}[1]{\mathbf{X}{#1}}
\newcommand{\stochF}[1]{\mathcal{S}^{\{#1\}}}
\newcommand{\detF}[1]{\mathcal{D}^{\{#1\}}}
\newcommand{\initXE}{(x_{-1},\epsilon_0)}
\newcommand{\nlEqnLHS}[4]{
  h_\varpi(#1,#2,E_t(#3),\epsilon_#4)}

\newcommand{\nlEqn}[4]{
h_\varpi^{det}(#1,#2,\epsilon_#4)+
H_\varpi^{det}(#1,#2,\epsilon_#4)E_#4(#3)
}
\newcommand{\nlEqnSel}[4]{
\varpi=m_\varpi^{det}(#1,#2,\epsilon_#4)+
M_\varpi^{det}(#1,#2,\epsilon_#4)E_#4(#3)
}
\newcommand{\itSup}[1]{{\{#1\}}}
\newcommand{\initX}{(x)}
\newcommand{\initXEN}{(x_,\epsilon_t)}
\newcommand{\detComp}[1]{{\detF{K-\nu}( \cdots \detF{K-1}(\detF{K}(#1))))}}
\newcommand{\tArg}{(x_{t-1},\epsilon_t)}
